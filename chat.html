<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>Chat</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="jquery-mobile/the-link.min.css" />
	<link rel="stylesheet" href="jquery-mobile/the-link.structure-1.0.min.css" />
	<script src="jquery-mobile/jquery-1.6.4.min.js"></script>
	<script src="jquery-mobile/jquery.mobile-1.0.min.js"></script> 
<script type="text/javascript" charset="utf-8" src="lol.js"></script>
</head>

<script type="text/javascript">
var respuesta1 = new Array();
var respuesta2 = new Array();
var fantasma;
var idr1;
var idr2;
var obj=cjson();
var stage=4;

function onload(){
var n = Math.floor((Math.random()*stage)+1);	
var hola;
//Colocamos el nombre del fantasma
		var name = new Array();
		name=window.location.search.substr(1).split("?");
		$('#spirit').text(name[0]);
		
//Seleccionamos el camino de Hola		
switch(n)
{
case 1:
  hola=1101;
  break;
case 2:
  hola=1201;
case 3:
  hola=1301;
  break;
default:
  hola=1401;
}

//obtenemos la pregunta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==hola)
	   {
fantasma=obj.conversacion.hola.guion[i].texto;
idr1=obj.conversacion.hola.guion[i].siguiente1;
idr2=obj.conversacion.hola.guion[i].siguiente2;
		break;
	   }
	}
//obtenemos primer respuesta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==idr1)
	   {
respuesta1[0]=obj.conversacion.hola.guion[i].texto;
respuesta1[1]=obj.conversacion.hola.guion[i].siguiente1;
		break;
	   }
	}
//obtenemos la segunda respuesta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==idr2)
	   {
respuesta2[0]=obj.conversacion.hola.guion[i].texto;
respuesta2[1]=obj.conversacion.hola.guion[i].siguiente1;
		break;
	   }
	}
//comenzamos a pintar
msg = document.getElementById('msg').getContext('2d');
msg2 = document.getElementById('msg2').getContext('2d');
msg3 = document.getElementById('msg3').getContext('2d');
btn1 = document.getElementById('btn1').getContext('2d');
btn2 = document.getElementById('btn2').getContext('2d');
	

//pregunta
var chat1 = new Image();
chat1.src = 'Imgs/ImgsConnect/dialog2.png';
chat1.onload = function(){
			msg.drawImage(chat1,0,0);
			msg.font="bold italic 20px Arial";
			msg.fillStyle = "#fff";
			msg.fillText(fantasma,110,50);
}
//respuestas
		var img1 = new Image();
		img1.src = 'Imgs/ImgsConnect/btnchat.png';
		
		img1.onload = function(){
			btn1.drawImage(img1,0,0);
			btn1.font="bold italic 20px Arial";
			btn1.fillStyle = "#fff";
			btn1.fillText(respuesta1[0],110,50);
   
			btn2.drawImage(img1,0,0);
			btn2.font="bold italic 20px Arial";
			btn2.fillStyle = "#fff";
			btn2.fillText(respuesta2[0],110,50);
		}

	}
	
function clickres()
    {
//obtenemos los canvas		
msg = document.getElementById('msg').getContext('2d');
msg2 = document.getElementById('msg2').getContext('2d');
msg3 = document.getElementById('msg3').getContext('2d');
btn1 = document.getElementById('btn1').getContext('2d');
btn2 = document.getElementById('btn2').getContext('2d');	
	
//limpiamos los canvas	
	
msg2.clearRect(0,0,600,600);
msg3.clearRect(0,0,600,600);
btn1.clearRect(0,0,600,600);
btn2.clearRect(0,0,600,600);

//dibujamos la respuesta del fantasma
var chat3 = new Image();
chat3.src = 'Imgs/ImgsConnect/dialog1.png';
chat3.onload = function(){
			msg2.drawImage(chat3,0,0);
			msg2.font="bold italic 20px Arial";
			msg2.fillStyle = "#fff";
			msg2.fillText(respuesta1[0],110,50);
}		
window.setTimeout('clickresf()',3000);
	}
function clickresf(){
//obtenemos la pregunta del fantasma
for(var i=0;i<100;i++)
{
if(obj.conversacion.hola.guion[i].id==respuesta1[1])
	   {
fantasma=obj.conversacion.hola.guion[i].texto;
idr1=obj.conversacion.hola.guion[i].siguiente1;
idr2=obj.conversacion.hola.guion[i].siguiente2;
		break;
	   }
	}
//dibujamos la respuesta del fantasma

var chat4 = new Image();
chat4.src = 'Imgs/ImgsConnect/dialog2.png';
chat4.onload = function(){
			msg3.drawImage(chat4,0,0);
			msg3.font="bold italic 20px Arial";
			msg3.fillStyle = "#fff";
			msg3.fillText(fantasma,110,50);
}	
	//obtenemos primer respuesta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==idr1)
	   {
respuesta1[0]=obj.conversacion.hola.guion[i].texto;
respuesta1[1]=obj.conversacion.hola.guion[i].siguiente1;
		break;
	   }
	}
//obtenemos la segunda respuesta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==idr2)
	   {
respuesta2[0]=obj.conversacion.hola.guion[i].texto;
respuesta2[1]=obj.conversacion.hola.guion[i].siguiente1;
		break;
	   }
	}
//respuestas
		var img1 = new Image();
		img1.src = 'Imgs/ImgsConnect/btnchat.png';
		
		img1.onload = function(){
			btn1.drawImage(img1,0,0);
			btn1.font="bold italic 20px Arial";
			btn1.fillStyle = "#fff";
			btn1.fillText(respuesta1[0],110,50);
   
			btn2.drawImage(img1,0,0);
			btn2.font="bold italic 20px Arial";
			btn2.fillStyle = "#fff";
			btn2.fillText(respuesta2[0],110,50);
		}
	}
	
function clickres2()
    {
//obtenemos los canvas		
msg = document.getElementById('msg').getContext('2d');
msg2 = document.getElementById('msg2').getContext('2d');
msg3 = document.getElementById('msg3').getContext('2d');
btn1 = document.getElementById('btn1').getContext('2d');
btn2 = document.getElementById('btn2').getContext('2d');

//limpiamos los canvas
	msg2.clearRect(0,0,600,600);
    msg3.clearRect(0,0,600,600);
	btn1.clearRect(0,0,600,600);
    btn2.clearRect(0,0,600,600);	
//dibujamos la respuesta del fantasma
var chat3 = new Image();
chat3.src = 'Imgs/ImgsConnect/dialog1.png';
chat3.onload = function(){
			msg2.drawImage(chat3,0,0);
			msg2.font="bold italic 20px Arial";
			msg2.fillStyle = "#fff";
			msg2.fillText(respuesta2[0],110,50);
}		
window.setTimeout('clickresf2()',3000);
	}
function clickresf2(){		
//obtenemos la pregunta del fantasma
for(var i=0;i<100;i++)
{
if(obj.conversacion.hola.guion[i].id==respuesta2[1])
	   {
fantasma=obj.conversacion.hola.guion[i].texto;
idr1=obj.conversacion.hola.guion[i].siguiente1;
idr2=obj.conversacion.hola.guion[i].siguiente2;
		break;
	   }
	}
//dibujamos la respuesta del fantasma
var chat4 = new Image();
chat4.src = 'Imgs/ImgsConnect/dialog2.png';
chat4.onload = function(){
			msg3.drawImage(chat4,0,0);
			msg3.font="bold italic 20px Arial";
			msg3.fillStyle = "#fff";
			msg3.fillText(fantasma,110,50);
}	

//obtenemos primer respuesta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==idr1)
	   {
respuesta1[0]=obj.conversacion.hola.guion[i].texto;
respuesta1[1]=obj.conversacion.hola.guion[i].siguiente1;
		break;
	   }
	}
//obtenemos la segunda respuesta
for(var i=0;i<100;i++)
{
	if(obj.conversacion.hola.guion[i].id==idr2)
	   {
respuesta2[0]=obj.conversacion.hola.guion[i].texto;
respuesta2[1]=obj.conversacion.hola.guion[i].siguiente1;
		break;
	   }
	}
//respuestas
		var img1 = new Image();
		img1.src = 'Imgs/ImgsConnect/btnchat.png';
		
		img1.onload = function(){
			btn1.drawImage(img1,0,0);
			btn1.font="bold italic 20px Arial";
			btn1.fillStyle = "#fff";
			btn1.fillText(respuesta1[0],110,50);
   
			btn2.drawImage(img1,0,0);
			btn2.font="bold italic 20px Arial";
			btn2.fillStyle = "#fff";
			btn2.fillText(respuesta2[0],110,50);
		}
	}	
		
	function onback(){       
		window.location.replace('menu.html'); 
	}
</script>

<style type="text/css">
    body {
		background-image: url(Imgs/ImgsMenu/fondo.png);
		background-repeat: repeat;
	}
    .title {
		font-family: Tahoma, Geneva, sans-serif;
	}
    body,td,th {
		color: #FFF;
	}
</style>

<body onload="onload()">
<div data-role="page" id="conect" style="background-image:url(Imgs/ImgsMenu/fondo.png); color:#FFF" align="center">

    <div data-role="header">
    	<a href="index.html" data-icon="delete">Close</a>
    	<h1 class="title" id="spirit">#spirit name#</h1>
        <a href="index.html" data-icon="refresh">Refresh</a>
    </div>

	<div data-role="content" >
		
  <p><canvas id="msg" width="500"></canvas><br/>     <canvas id="msg2" width="500"></canvas><br/>
     <canvas id="msg3" width="500"></canvas>
        </p>
        <canvas id="btn1" width="400" onclick="clickres();"></canvas>
		<canvas id="btn2" width="400" onclick="clickres2();"></canvas>
	</div>
    
    <div data-role="footer" data-id="navMenu" data-position="fixed">
		<div data-role="navbar">
			<ul>
				<li><a href="index.html" data-role="button" data-icon="info">More</a></li>
				<li><a href="index.html" data-role="button" data-icon="home">Menu</a></li>
            	<li><a href="intro.html" data-role="button" data-icon="grid">Instructions</a></li>
			</ul>
		</div>
    </div>
</div>
</body>
</html>
